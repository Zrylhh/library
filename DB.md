### Oracle


1. oracle存储单元，数据块（block）


#### 常用字符集

汉字：ZHS16GBK
通用: AL32UTF8

#### 表

要善用表空间

#### 数据类型

常用 NUMBER VARCHAR2 CLOB BLOB
时间视精度而定

时间精度|类型
:-:|:-:
大于1天|VARCHAR2
大于1秒|DATE
小于1秒|TIMESTAMP


#### 视图
对于oracle只是会在执行sql时将视图替换为创建时的sql，不会有性能优化，只能用于简化代码。

#### 索引（索引）
    
1. 普通B树索引
    例如对0-10000进行索引，那么就分割为0-50、51-100...等数据块，然后再对数据块索引
    
    优势：可以快速定位到一小部分数据（查的快）
    order by 、group by、distinct等会引起排序的操作要利用索引（频繁使用时）

    劣势：索引会影响DML（增删改）的性能，所以一张表不要超过5个索引。
    查询大量数据时全表扫描更好，推荐5%以下数据建索引，15%以上全表扫描。

2. 反向键索引
3. 函数索引
4. 位图索引

#### SQL
    
避免隐式转换，例如

```
    // class_id 是varchar2
    where class_id = 2018001   // 对于oracle，可能不会将 2018001转换为字符型来比较，而是将class_id转化为number来比较
    where class_id = '2018001'
```

尽量使用union all 而不是union，union会去重引起排序。

like ，'%' 出现在字符串前会无法使用索引。

**执行计划**: 可以分析一句sql，oracle执行的过程，例如是全表扫描还是索引，先访问那一张表等，可以用于优化sql。

#### DML

delete操作比较频繁的表，应改用假删除。
因为oracle默认会把删掉的记录记录下来，在oracle崩溃时可以用来修复短时间内的数据。

#### 复杂查询语句

表连接不宜超过5个，嵌套不宜超过5个（不关联表的嵌套不计数）。

#### HINT

可以固定**执行计划**

#### DBLink

不建议用，应用之间还是应该走接口。

#### PLSQL

varchar2的输出参数不要超过50（内存占用过多），可以改用游标。

#### 统计信息

oracle会自动统计表的数据，例如数据量、数据分布、索引等，便于后续执行sql时安排执行计划，可以手动调用命令来让oracle分析。
没有统计信息的表执行sql效率会低。